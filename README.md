### **Repository Roadmap**

The system consists of several Python scripts that work together to implement the scheme:

* **key\_generator.py** : Generates the public parameters and the master secret keys. Each time this script is executed, it produces a new set of public keys and master secret keys. It should be run once at the initialization phase of the scheme. 

* **Key Issuer.py** : Takes the master secret keys and public keys generated by key\_generator.py, then computes each vehicleâ€™s credential values $A\_i$ and $x\_i$. These values are then delivered securely to each vehicle.

* **signer\_pi\_batch\_parallel.py** : Allows each vehicle to generate a signature on a message of the form ts||message using its assigned secret values.

* **verifier\_final.py** : Enables any party, including potential adversaries, to verify the validity of a signature using only the public keys. 



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



### **System Architecture and communication flows:**

![Architecture](https://raw.githubusercontent.com/Aminmohammadali/C-ITS/main/Arch.jpg width="400" alt="Architecture") 

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
### **Description:** 

In our scheme, we consider three entities: the TA, TC, and AS. In the implementation, the TA runs the key generator and produces the public and secret keys for both the AS and the TC. Once the TA generates the public parameters, they are uploaded to the key-load module so that all entities can retrieve them. Therefore, all public and private keys are unique and remain unchanged unless the TA re-runs the key-generation process to produce new parameters.



Whenever a vehicle requires its secret parameters, it sends a request to the TA, and the TA provides the tuple $(A\_i, x\_i, y\_i)$. After receiving these values, the vehicle can generate endorsements for the messages it receives from the RSU. The user runs the signer code with its secret and public parameters to produce a signature using \\texttt{signer\_pi\_batch\_parallel.py}, and then sends the result to the verifier (in this case, the RSU). The RSU or any other entity can verify the endorsement using \\texttt{verifier\_final.py}.



To evaluate attacks and simulate a dynamic environment, we model a realistic scenario in which each RSU receives a large number of endorsements from vehicles. For this purpose, we designed the signer module to generate many signatures based on the required threshold. Note that in this model, Sybil-attack detection is deactivated so that the verifier does not perform Sybil checking. Sybil detection is enabled only in the dedicated Sybil-attack scenario.



Furthermore, we show that our scheme is resistant to replay  and unforgeability attacks. In the dynamic-environment experiment, we introduce delay and jitter using CMD commands to emulate network conditions and examine their effects on message transmission between vehicles and RSUs.
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

### **Setup:** 

This library cannot be installed on Windows laptops. Please use a macOS system or a Raspberry Pi 4 or 5 instead.

* **Open s.s.l library**: First of all. install Open s.s.l library on your Python code..
* **Open bplib**: Once Open s.s.l is installed, you can proceed to install bplib.
* **Run Codes**: The system is now ready. Run the generated code using the following CMD commands:

**1. Signer CMD code**: /home/pi/projects/bplib\_test/.venv/bin/python   /home/pi/Downloads/signer\_pi\_batch\_parallel.py   --host 192.168.2.2   --port 5000   --message "1212122423||Alice"   --count 1   --runs 10

**2. Signer CMD code with delay and jiter**: /home/pi/projects/bplib\_test/.venv/bin/python   /home/pi/Downloads/signer\_pi\_batch\_parallel\_delayandjiter.py   --host 192.168.2.2   --port 5000   --message "1212122423||Alice"   --count 10   --runs 1000   --delay-mu 20   --delay-sigma 10   --output results\_mu20\_sigma10.json

**3. Verifier CMD code**: python3 /home/mmobarak/Downloads/verifier\_final.py --host 0.0.0.0  --port 5000   --disable-sybil

**4. Verifier CMD code for sybil attack check**: python3 /home/mmobarak/Downloads/verifier\_final.py --host 0.0.0.0  --port 5000
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////